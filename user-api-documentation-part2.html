<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>电费账单系统 - 用户端API文档（第二部分）</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            line-height: 1.6;
            color: #333;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        h1, h2, h3, h4 {
            color: #2c3e50;
        }
        .api-section {
            margin-bottom: 30px;
            padding: 20px;
            border: 1px solid #eee;
            border-radius: 5px;
            box-shadow: 0 2px 12px rgba(0, 0, 0, 0.05);
        }
        .api-item {
            margin-bottom: 20px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 4px;
            border-left: 4px solid #409EFF;
        }
        .method {
            display: inline-block;
            padding: 3px 8px;
            border-radius: 3px;
            font-weight: bold;
            margin-right: 10px;
        }
        .get { background: #e3f2fd; color: #1976d2; }
        .post { background: #e8f5e9; color: #2e7d32; }
        .put { background: #fff3e0; color: #f57c00; }
        .delete { background: #ffebee; color: #c62828; }
        .url {
            font-family: monospace;
            background: #f1f1f1;
            padding: 2px 5px;
            border-radius: 3px;
        }
        .param-table {
            width: 100%;
            border-collapse: collapse;
            margin: 10px 0;
        }
        .param-table th, .param-table td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
        }
        .param-table th {
            background: #f5f5f5;
        }
        .required {
            color: #f44336;
            font-weight: bold;
        }
        pre {
            background: #f8f9fa;
            padding: 10px;
            border-radius: 4px;
            overflow: auto;
            font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
            border: 1px solid #eee;
        }
        .description {
            color: #606060;
            margin-bottom: 15px;
        }
        .api-section h2 {
            border-bottom: 2px solid #eee;
            padding-bottom: 10px;
            margin-top: 0;
        }
        .doc-header {
            background: #409EFF;
            color: white;
            padding: 20px;
            border-radius: 5px;
            margin-bottom: 30px;
            text-align: center;
        }
        .doc-header h1 {
            color: white;
            margin: 0;
        }
        .doc-header p {
            margin: 10px 0 0 0;
            opacity: 0.8;
        }
        .code-title {
            font-weight: bold;
            margin-bottom: 5px;
            color: #444;
        }
        .function-name {
            color: #0366d6;
            font-weight: bold;
        }
        .jsdoc {
            color: #6a737d;
            font-style: italic;
        }
    </style>
</head>
<body>
    <div class="doc-header">
        <h1>电费账单系统 - 用户端API文档</h1>
        <p>第二部分：通知管理和用电分析</p>
    </div>

    <div class="api-section">
        <h2>1. 通知管理</h2>
        <p class="description">通知管理模块提供用户获取通知列表、标记通知已读、获取未读通知数量等功能。</p>
        
        <div class="api-item">
            <h3>获取通知列表</h3>
            <div class="method get">GET</div>
            <div class="url">/api/user/notifications</div>
            <p>获取用户通知列表，支持分页查询</p>
            
            <div class="code-title">前端实现代码:</div>
            <pre>
import request from '@/utils/request';

/**
 * 获取通知列表
 * @param {Object} params 查询参数
 * @param {number} params.page 页码
 * @param {number} params.pageSize 每页数量
 * @returns {Promise} 返回Promise对象，包含通知列表
 */
export function getNotifications(params) {
  return request({
    url: '/api/user/notifications',
    method: 'get',
    params
  });
}</pre>
            
            <h4>参数：</h4>
            <table class="param-table">
                <tr>
                    <th>参数名</th>
                    <th>类型</th>
                    <th>必填</th>
                    <th>说明</th>
                </tr>
                <tr>
                    <td>page</td>
                    <td>number</td>
                    <td>否</td>
                    <td>页码，默认1</td>
                </tr>
                <tr>
                    <td>pageSize</td>
                    <td>number</td>
                    <td>否</td>
                    <td>每页数量，默认10</td>
                </tr>
            </table>
            
            <h4>返回数据：</h4>
            <pre>
{
    "total": "number",           // 总记录数
    "items": [                   // 通知列表
        {
            "id": "string",      // 通知ID
            "title": "string",   // 通知标题
            "content": "string", // 通知内容
            "type": "string",    // 通知类型
            "createTime": "string", // 创建时间
            "isRead": "boolean"  // 是否已读
        }
    ]
}</pre>
        </div>

        <div class="api-item">
            <h3>标记通知已读</h3>
            <div class="method put">PUT</div>
            <div class="url">/api/user/notifications/{notificationId}/read</div>
            <p>将指定通知标记为已读</p>
            
            <div class="code-title">前端实现代码:</div>
            <pre>
/**
 * 标记通知已读
 * @param {string} notificationId 通知ID
 * @returns {Promise} 返回Promise对象，包含标记结果
 */
export function markNotificationRead(notificationId) {
  return request({
    url: `/api/user/notifications/${notificationId}/read`,
    method: 'put'
  });
}</pre>
            
            <h4>参数：</h4>
            <table class="param-table">
                <tr>
                    <th>参数名</th>
                    <th>类型</th>
                    <th>必填</th>
                    <th>说明</th>
                </tr>
                <tr>
                    <td>notificationId</td>
                    <td>string</td>
                    <td class="required">是</td>
                    <td>通知ID</td>
                </tr>
            </table>
        </div>

        <div class="api-item">
            <h3>标记所有通知已读</h3>
            <div class="method put">PUT</div>
            <div class="url">/api/user/notifications/read-all</div>
            <p>将所有通知标记为已读</p>
            
            <div class="code-title">前端实现代码:</div>
            <pre>
/**
 * 标记所有通知已读
 * @returns {Promise} 返回Promise对象，包含标记结果
 */
export function markAllNotificationsRead() {
  return request({
    url: '/api/user/notifications/read-all',
    method: 'put'
  });
}</pre>
        </div>

        <div class="api-item">
            <h3>删除通知</h3>
            <div class="method delete">DELETE</div>
            <div class="url">/api/user/notifications/{notificationId}</div>
            <p>删除指定通知</p>
            
            <div class="code-title">前端实现代码:</div>
            <pre>
/**
 * 删除通知
 * @param {string} notificationId 通知ID
 * @returns {Promise} 返回Promise对象，包含删除结果
 */
export function deleteNotification(notificationId) {
  return request({
    url: `/api/user/notifications/${notificationId}`,
    method: 'delete'
  });
}</pre>
            
            <h4>参数：</h4>
            <table class="param-table">
                <tr>
                    <th>参数名</th>
                    <th>类型</th>
                    <th>必填</th>
                    <th>说明</th>
                </tr>
                <tr>
                    <td>notificationId</td>
                    <td>string</td>
                    <td class="required">是</td>
                    <td>通知ID</td>
                </tr>
            </table>
        </div>

        <div class="api-item">
            <h3>获取未读通知数量</h3>
            <div class="method get">GET</div>
            <div class="url">/api/user/notifications/unread-count</div>
            <p>获取用户未读通知数量</p>
            
            <div class="code-title">前端实现代码:</div>
            <pre>
/**
 * 获取未读通知数量
 * @returns {Promise} 返回Promise对象，包含未读通知数量
 */
export function getUnreadCount() {
  return request({
    url: '/api/user/notifications/unread-count',
    method: 'get'
  });
}</pre>
            
            <h4>返回数据：</h4>
            <pre>
{
    "count": "number"   // 未读通知数量
}</pre>
        </div>

        <div class="api-item">
            <h3>更新通知设置</h3>
            <div class="method put">PUT</div>
            <div class="url">/api/user/notifications/settings</div>
            <p>更新用户通知设置</p>
            
            <div class="code-title">前端实现代码:</div>
            <pre>
/**
 * 更新通知设置
 * @param {Object} data 通知设置
 * @param {boolean} data.emailNotification 是否开启邮件通知
 * @param {boolean} data.smsNotification 是否开启短信通知
 * @param {boolean} data.billReminder 是否开启账单提醒
 * @param {boolean} data.paymentReminder 是否开启缴费提醒
 * @param {boolean} data.usageAlert 是否开启用电预警
 * @returns {Promise} 返回Promise对象，包含更新结果
 */
export function updateNotificationSettings(data) {
  return request({
    url: '/api/user/notifications/settings',
    method: 'put',
    data
  });
}</pre>
            
            <h4>请求参数：</h4>
            <table class="param-table">
                <tr>
                    <th>参数名</th>
                    <th>类型</th>
                    <th>必填</th>
                    <th>说明</th>
                </tr>
                <tr>
                    <td>emailNotification</td>
                    <td>boolean</td>
                    <td>否</td>
                    <td>是否开启邮件通知</td>
                </tr>
                <tr>
                    <td>smsNotification</td>
                    <td>boolean</td>
                    <td>否</td>
                    <td>是否开启短信通知</td>
                </tr>
                <tr>
                    <td>billReminder</td>
                    <td>boolean</td>
                    <td>否</td>
                    <td>是否开启账单提醒</td>
                </tr>
                <tr>
                    <td>paymentReminder</td>
                    <td>boolean</td>
                    <td>否</td>
                    <td>是否开启缴费提醒</td>
                </tr>
                <tr>
                    <td>usageAlert</td>
                    <td>boolean</td>
                    <td>否</td>
                    <td>是否开启用电预警</td>
                </tr>
            </table>
        </div>
    </div>

    <div class="api-section">
        <h2>2. 用电分析</h2>
        <p class="description">用电分析模块提供用户获取用电趋势数据、年度用电分析、用电对比数据、节能建议等功能。</p>
        
        <div class="api-item">
            <h3>获取用电趋势数据</h3>
            <div class="method get">GET</div>
            <div class="url">/api/user/analysis/trend</div>
            <p>获取用户用电趋势数据</p>
            
            <div class="code-title">前端实现代码:</div>
            <pre>
import request from '@/utils/request';

/**
 * 获取用电趋势数据
 * @param {Object} params 查询参数
 * @param {string} params.startDate 开始日期（YYYY-MM-DD）
 * @param {string} params.endDate 结束日期（YYYY-MM-DD）
 * @param {string} params.type 数据类型（daily/weekly/monthly，可选）
 * @returns {Promise} 返回Promise对象，包含用电趋势数据
 */
export function getElectricityTrend(params) {
  return request({
    url: '/api/user/analysis/trend',
    method: 'get',
    params
  });
}</pre>
            
            <h4>参数：</h4>
            <table class="param-table">
                <tr>
                    <th>参数名</th>
                    <th>类型</th>
                    <th>必填</th>
                    <th>说明</th>
                </tr>
                <tr>
                    <td>startDate</td>
                    <td>string</td>
                    <td class="required">是</td>
                    <td>开始日期（YYYY-MM-DD）</td>
                </tr>
                <tr>
                    <td>endDate</td>
                    <td>string</td>
                    <td class="required">是</td>
                    <td>结束日期（YYYY-MM-DD）</td>
                </tr>
                <tr>
                    <td>type</td>
                    <td>string</td>
                    <td>否</td>
                    <td>数据类型（daily/weekly/monthly）</td>
                </tr>
            </table>
            
            <h4>返回数据：</h4>
            <pre>
{
    "data": [                    // 趋势数据
        {
            "date": "string",    // 日期
            "usage": "number",   // 用电量
            "cost": "number"     // 电费
        }
    ],
    "summary": {                 // 统计摘要
        "totalUsage": "number",  // 总用电量
        "totalCost": "number",   // 总电费
        "avgUsage": "number",    // 平均用电量
        "avgCost": "number"      // 平均电费
    }
}</pre>
        </div>

        <div class="api-item">
            <h3>获取年度用电分析</h3>
            <div class="method get">GET</div>
            <div class="url">/api/user/analysis/yearly</div>
            <p>获取用户年度用电分析数据</p>
            
            <div class="code-title">前端实现代码:</div>
            <pre>
/**
 * 获取年度用电分析
 * @param {Object} params 查询参数
 * @param {number} params.year 年份
 * @returns {Promise} 返回Promise对象，包含年度用电分析数据
 */
export function getYearlyAnalysis(params) {
  return request({
    url: '/api/user/analysis/yearly',
    method: 'get',
    params
  });
}</pre>
            
            <h4>参数：</h4>
            <table class="param-table">
                <tr>
                    <th>参数名</th>
                    <th>类型</th>
                    <th>必填</th>
                    <th>说明</th>
                </tr>
                <tr>
                    <td>year</td>
                    <td>number</td>
                    <td class="required">是</td>
                    <td>年份（如：2023）</td>
                </tr>
            </table>
            
            <h4>返回数据：</h4>
            <pre>
{
    "summary": {                 // 年度汇总
        "totalUsage": "number",  // 年度总用电量
        "totalCost": "number",   // 年度总电费
        "averageMonthlyUsage": "number", // 平均月用电量
        "usageYoY": "number",    // 用电量同比变化率
        "costYoY": "number",     // 电费同比变化率
        "avgUsageYoY": "number"  // 平均用电量同比变化率
    },
    "monthlyData": [             // 月度数据
        {
            "month": "number",   // 月份
            "usage": "number",   // 用电量
            "cost": "number",    // 电费
            "peakUsage": "number", // 峰时用电量
            "valleyUsage": "number" // 谷时用电量
        }
    ],
    "timeDistribution": {        // 用电时段分布
        "peak": "number",        // 峰时用电比例
        "valley": "number",      // 谷时用电比例
        "flat": "number"         // 平时用电比例
    },
    "typeDistribution": {        // 用电类型分布
        "lighting": "number",    // 照明用电比例
        "appliance": "number",   // 家电用电比例
        "heating": "number",     // 采暖用电比例
        "other": "number"        // 其他用电比例
    },
    "analysis": [                // 用电分析
        {
            "content": "string"  // 分析内容
        }
    ],
    "suggestions": [             // 节电建议
        {
            "title": "string",   // 建议标题
            "content": "string", // 建议内容
            "savingPotential": "string" // 预计节省
        }
    ],
    "comparison": {              // 同类型用户比较
        "userUsage": "number",   // 用户用电量
        "averageUsage": "number", // 同类型用户平均用电量
        "percentile": "number"   // 用户用电量百分位
    }
}</pre>
        </div>

        <div class="api-item">
            <h3>获取用电对比数据</h3>
            <div class="method get">GET</div>
            <div class="url">/api/user/analysis/comparison</div>
            <p>获取用户用电对比数据</p>
            
            <div class="code-title">前端实现代码:</div>
            <pre>
/**
 * 获取用电对比数据
 * @param {Object} params 查询参数
 * @param {number} params.year 年份
 * @param {number} params.prevYear 对比年份（可选）
 * @returns {Promise} 返回Promise对象，包含用电对比数据
 */
export function getElectricityComparison(params) {
  return request({
    url: '/api/user/analysis/comparison',
    method: 'get',
    params
  });
}</pre>
            
            <h4>参数：</h4>
            <table class="param-table">
                <tr>
                    <th>参数名</th>
                    <th>类型</th>
                    <th>必填</th>
                    <th>说明</th>
                </tr>
                <tr>
                    <td>year</td>
                    <td>number</td>
                    <td class="required">是</td>
                    <td>当前年份</td>
                </tr>
                <tr>
                    <td>prevYear</td>
                    <td>number</td>
                    <td>否</td>
                    <td>对比年份（不填则系统自动选择上一年）</td>
                </tr>
            </table>
        </div>

        <div class="api-item">
            <h3>获取节能建议</h3>
            <div class="method get">GET</div>
            <div class="url">/api/user/analysis/tips</div>
            <p>获取节能建议</p>
            
            <div class="code-title">前端实现代码:</div>
            <pre>
/**
 * 获取节能建议
 * @param {Object} params 查询参数
 * @param {number} params.limit 获取数量限制（可选）
 * @returns {Promise} 返回Promise对象，包含节能建议
 */
export function getEnergySavingTips(params) {
  return request({
    url: '/api/user/analysis/tips',
    method: 'get',
    params
  });
}</pre>
            
            <h4>参数：</h4>
            <table class="param-table">
                <tr>
                    <th>参数名</th>
                    <th>类型</th>
                    <th>必填</th>
                    <th>说明</th>
                </tr>
                <tr>
                    <td>limit</td>
                    <td>number</td>
                    <td>否</td>
                    <td>返回建议的数量限制，默认5</td>
                </tr>
            </table>
        </div>

        <div class="api-item">
            <h3>获取用电时段分布</h3>
            <div class="method get">GET</div>
            <div class="url">/api/user/analysis/time-distribution</div>
            <p>获取用户用电时段分布数据</p>
            
            <div class="code-title">前端实现代码:</div>
            <pre>
/**
 * 获取用电时段分布
 * @param {Object} params 查询参数
 * @param {string} params.startDate 开始日期（YYYY-MM-DD，可选）
 * @param {string} params.endDate 结束日期（YYYY-MM-DD，可选）
 * @returns {Promise} 返回Promise对象，包含用电时段分布数据
 */
export function getTimeDistribution(params) {
  return request({
    url: '/api/user/analysis/time-distribution',
    method: 'get',
    params
  });
}</pre>
            
            <h4>参数：</h4>
            <table class="param-table">
                <tr>
                    <th>参数名</th>
                    <th>类型</th>
                    <th>必填</th>
                    <th>说明</th>
                </tr>
                <tr>
                    <td>startDate</td>
                    <td>string</td>
                    <td>否</td>
                    <td>开始日期（YYYY-MM-DD）</td>
                </tr>
                <tr>
                    <td>endDate</td>
                    <td>string</td>
                    <td>否</td>
                    <td>结束日期（YYYY-MM-DD）</td>
                </tr>
            </table>
        </div>

        <div class="api-item">
            <h3>获取用电类型分布</h3>
            <div class="method get">GET</div>
            <div class="url">/api/user/analysis/type-distribution</div>
            <p>获取用户用电类型分布数据</p>
            
            <div class="code-title">前端实现代码:</div>
            <pre>
/**
 * 获取用电类型分布
 * @param {Object} params 查询参数
 * @param {string} params.startDate 开始日期（YYYY-MM-DD，可选）
 * @param {string} params.endDate 结束日期（YYYY-MM-DD，可选）
 * @returns {Promise} 返回Promise对象，包含用电类型分布数据
 */
export function getTypeDistribution(params) {
  return request({
    url: '/api/user/analysis/type-distribution',
    method: 'get',
    params
  });
}</pre>
            
            <h4>参数：</h4>
            <table class="param-table">
                <tr>
                    <th>参数名</th>
                    <th>类型</th>
                    <th>必填</th>
                    <th>说明</th>
                </tr>
                <tr>
                    <td>startDate</td>
                    <td>string</td>
                    <td>否</td>
                    <td>开始日期（YYYY-MM-DD）</td>
                </tr>
                <tr>
                    <td>endDate</td>
                    <td>string</td>
                    <td>否</td>
                    <td>结束日期（YYYY-MM-DD）</td>
                </tr>
            </table>
        </div>
    </div>
</body>
</html> 